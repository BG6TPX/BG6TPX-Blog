## 前言
身为一名电子爱好者，一直期待拥有自己的homelib好久了，服务器平台，软硬件开发，测试，单片机，DSP，电机，AI，FPGA，ASIC，软件无线电SDR，等各种技术一体的Homelib，因此开启了我的捡垃圾之旅。此篇文章就当作作者的念念碎以此铭记折腾之旅

### 目的(用途)：
核心框架：服务器平台，服务器我主要有4个用途
1. 做嵌入式开发时需要ARM的交叉编译器和GDB调试，一般在Ubuntu/Windwos上较为合适
2. 做FPGA开发时需要Xilinx及其组件和数字IC开发时相关的Synopsys和Cadence家EDA，这个只能在Centos或者Redhat上进行
3. 需要我在外出时帮忙远程处理文件和回复客户信息的Windows
4. 还需要能随时外网访问的NAS，这里我用的黑群晖
5. 允许Docker部署个人博客和网站

### 1.总体框架设计
我将服务器机柜划分成：计算层，网络层，以及存储层的三层结构

#### 1.1计算层
服务器选择：
综合成本，功耗，噪音，远程管理等因素。笔者选择了Dell R730 3.5寸8盘位那款，这款国内很多机房等退役的2U机架式服务器。准系统(不带CPU，内存，硬盘等配件)，
仅有主板和配套机箱的准系统，价格上仅需千元左右，但是入手之前建议考虑各位读者的环境
 建议：
1. 家里要有储物房可以放置，服务器噪音较大，虽说风扇可调但是噪音也不小。建议读者先多考察一下服务器噪音。
2. 如果家里没空间，可以选择放置在老家，宽敞，也不吵到家里人。
3. 服务器放置地点最好是有公网IP(动态的)，国内的话，除了移动明确不会给之外，大部分电信和联通都会给。

现在准系统有了，我们依次来选择CPU，内存，硬盘，电源,以及显卡。
CPU：笔者选择的是2颗E5-2683V4，总结32核心64线程,大部分读者选择2680V4就足够了，当然根据每个人的需求来定，仁者见仁，智者见智。
内存：笔者选择的是32G*4 一共128G的DDR4。
硬盘：系统盘笔者这里选择了2根1T的NVME固态当作系统盘(不用机械盘当系统盘是觉得NVME在系统运行上会更快，况且现在市面上NVME固态已经很便宜了，一般折腾这个的手上多少有一些NVME固态，一般问题不大)，机械盘方面，笔者选购了2个4T硬盘组成raid0给NAS使用。
电源：笔者选择了2个750W的EPP电源(EPP据说全部插上的时候会更加省电)。
阵列卡：笔者选择了H730-P，带有2G缓存
启动U盘：因为服务器本身只允许主硬盘启动(前面板的机械硬盘),需要在服务器内部增加一个引导U盘，引导PCIE插槽上的NVME硬盘启动。
显卡：笔者选择了P40(支持虚拟化)和1080ti(直通大显存)

----------2024.6月更
由于老志强E5功耗过高，性能不是那么足够，因此笔者在2月份的时候出给了同事，也带他入坑了（笑，因此从新选购了一台国鑫的SR201-12DR服务器。可以搭载双路霄龙Epyc服务器

----------2024.10月初更
国鑫的准系统被师兄拿去跑博士论文了，因此新入手了同泰怡的T1DEEP，搭载双路EPYC7K62(96核心192线程)+256G的DDR4 ECC内存,这个主板啥都挺好的，标准的EATX主板，PCIE可以任意拆分(笔者这边买的早期版本，更换了几个BIOS最终才折腾好)，唯一有遗憾的就是
他的2个SlimSAS8654接口并不是我们行业内通常的标准的8654接口，线序不一样，只能使用他们自己家的转接线转接U.2硬盘
因此现在的配置是：
CPU：笔者选择的是2颗EPYC-7K62，总结192核心96线程。
内存：笔者选择的是32G*16 一共512G的DDR4 3200。
硬盘：系统盘笔者这里选择了1根2T的NVME固态当作系统盘,1个大船或的Intel P4510当作编译盘，机械盘方面，笔者选购了1个4T硬盘当作临时编译盘。
电源：笔者选择了1个1000W的海运铂金电源。
阵列卡：无
显卡：暂无，准备选择4060ti 16G 炼丹的不二选择


#### 1.2网络层
路由器：
    笔者选择中兴的巡天AX3000Pro+和巡天AX3000组网
----------2024.6月更新
    家里由于是3层，因此2个路由器不太足够了，所以笔者在2024.618增加一台中兴的BE5100Pro+ WiFi7路由器当作核心路由器和原本的中兴路由器组网

光猫：
    笔者选择电信FTTR套餐送的中兴的G7615V2万兆光猫

交换机：
    笔者选择了2光(10G)+4电(2.5G)的万兆交换机


#### 1.3存储层面
笔者这里选择了intel的消费级i3-12100当作NAS存储，优势主要是有2点
    1.intel核显可以硬解视频，方便当作影音服务器
    2.4核8线程当作NAS足够了，耗电低，
但是问题来了，笔者选购的H610主板有且仅有一个PCIE4.0X16和一个PCIE3.0X1，此时我插上了X520 10G网卡了。机缘巧合之下，找到了2篇文章，讲解12代CPU如何通过硬件配置拆分
[PCIE拆分讲解](https://www.bilibili.com/read/cv15596863/)  
[12代，13代CPU PCIE拆分](https://www.bilibili.com/read/cv16530665/?spm_id_from=333.999.0.0)
笔者在这里用铅笔将CFG[5]引脚和GND连接起来，咸鱼淘了一张拆分卡，将X16，拆分成8+8分别跟网卡和HBA直通卡(最多可以挂8个硬盘)使用
硬盘：笔者趁双11打折，买了2个16T企业级机械当作存储

------------------2024.10.20日更新
上述的拆分太不稳定了，笔者直接把原来的H610更换成了铭瑄B760M终结者，这样就有了一根X16+X4+X4*2(NVME转接)的PCIE插槽了，就可以不用拆分X16的PCIE插槽和担心损坏CPU了
然后笔者采购了一张LSI3008-8i的HBA直通卡和一个intel的P4510 1T的U.2硬盘+intel X520双口网卡，分别工作在X4上，留下一根5.0X16的插槽后期给显卡使用，SI3008的2根8643的线直接把国鑫的36盘的服务器接起来，让最大可以挂载36个硬盘

